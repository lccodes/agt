<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Studio 1</title>
  <meta name="description" content="CS100 Studio #1">

  <script type="text/javascript" src="//code.jquery.com/jquery-1.11.0.min.js"></script>
  <script type="text/javascript" src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" type="text/javascript"></script>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/jquery.slick/1.6.0/slick.css"/>
  <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/jquery.slick/1.6.0/slick-theme.css"/>
  <script type="text/javascript" src="//cdn.jsdelivr.net/jquery.slick/1.6.0/slick.min.js"></script>
  <script type="text/javascript" src="//cs.brown.edu/courses/cs100/js/main.js"></script>
  <link rel="stylesheet" href="//cs.brown.edu/courses/cs100/css/main.css">
  <link rel="canonical" href="//cs.brown.edu/courses/cs100/studios/studio-1">
  <link rel="alternate" type="application/rss+xml" title="CS100: Data Fluency for All" href="//cs.brown.edu/courses/cs100/feed.xml">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Josefin+Slab:100,300,400,600,700,100italic,300italic,400italic,600italic,700italic" rel="stylesheet" type="text/css">
</head>


  <body>

    <header class="site-header">
  <div class="brand">CS100: Data Fluency For All</div>

  <!-- Navigation -->
  <nav class="navbar navbar-default" role="navigation">
      <div class="container">
          <!-- Brand and toggle get grouped for better mobile display -->
          <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                  <span class="sr-only">Toggle navigation</span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
              </button>
              <!-- navbar-brand is hidden on larger screens, but visible when the menu is collapsed -->
              <a class="navbar-brand" href="#">Data Fluency</a>
          </div>
          <!-- Collect the nav links, forms, and other content for toggling -->
          <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
              <ul class="nav navbar-nav">
                  <li>
                      <a href="//cs.brown.edu/courses/cs100/">Home</a>
                  </li>
                  <li>
                      <a href="//cs.brown.edu/courses/cs100/staff/">Staff</a>
                  </li>
                  <li>
                      <a href="//cs.brown.edu/courses/cs100/lectures">Lectures</a>
                  </li>
                  <li>
                      <a href="//cs.brown.edu/courses/cs100/homework/">Homework</a>
                  </li>
                  <li>
                      <a href="//cs.brown.edu/courses/cs100/studios/">Studios</a>
                  </li>
                  <li>
                      <a href="//cs.brown.edu/courses/cs100/hours/">Hours</a>
                  </li>
                  <li>
                      <a href="//cs.brown.edu/courses/cs100/students/">Submissions</a>
                  </li>
              </ul>
          </div>
          <!-- /.navbar-collapse -->
      </div>
      <!-- /.container -->
  </nav>

</header>


    <div class="page-content">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <div class="container">
        <div class="row">
            <div class="box">
                    <h1 id="cs100-studio-1">CS100 Studio #1</h1>

<h3 id="introduction-to-spreadsheets">Introduction to Spreadsheets</h3>

<h5 id="week-of-september-19-2016">Week of September 19, 2016</h5>

<h3 id="instructions">Instructions:</h3>
<p>During today’s studio, you will begin getting acquainted with data and data wrangling. You will be working in Calc, which is the spreadsheet program within LibreOffice. As you complete this studio, write your answers on a sheet of paper, or type them into a text file. If you have any questions along the way, raise your hand, and a TA will come over and help you.</p>

<p>Upon completion of all of today’s tasks, a TA will give you credit for today’s studio. If you do not manage to complete all the assigned work during the studio period, do not worry. You can continue to work on this assignment until midnight on the Tuesday following this studio. Come by TA hours any time before then to show us your completed work and get credit for today’s studio.</p>

<h3 id="objectives">Objectives:</h3>
<p>By the end of this studio, you will know how to process data in spreadsheets using LibreOffice Calc. This includes:</p>

<ul>
  <li>
    <p>Loading csv files</p>
  </li>
  <li>
    <p>Writing formulas</p>
  </li>
  <li>
    <p>Sorting and filtering data</p>
  </li>
  <li>
    <p>Creating pivot tables</p>
  </li>
  <li>
    <p>Charting data</p>
  </li>
</ul>

<h3 id="introduction-to-libreoffice">Introduction to LibreOffice</h3>
<p>LibreOffice is a free, open-source alternative to Microsoft Office. You can find LibreOffice (but not Microsoft Office) on all of the Brown CS department machines, and you can easily install LibreOffice onto a personal computer.</p>

<p>LibreOffice includes a variety of tools (for creating documents, presentations, etc.). Today we will be using LibreOffice Calc, a program for working with spreadsheets. The skills you learn using LibreOffice Calc are easily transferable to Google Sheets or Microsoft Excel.</p>

<p>During this week’s and next week’s studios, we will be learning some of the most useful tools of LibreOffice Calc. If at any point you would like to learn more, an in-depth guide can be found <a href="https://wiki.documentfoundation.org/images/4/47/CG41-CalcGuideLO.pdf">here</a>.</p>

<p>*Note: Today’s studio refers to the LibreOffice version found on the CS department’s computers. For those of you who are using LibreOffice on your personal laptop, the toolbars and functionality may be a bit different. If you need any assistance navigating LibreOffice on your personal laptop, feel free to ask a TA for help.</p>

<h3 id="data">Data</h3>
<p>Today, we’ll be analyzing a variety of breakfast cereals. Click on this <a href="//cs.brown.edu/courses/cs100/studios/data/1/cerealData.csv">link</a> to download cerealData.csv, a table of 77 brands of popular cereals in the US, along with nutritional, and other information about them. Open LibreOffice Calc on your computer, and then open the cerealData.csv file. Spend a few minutes perusing the spreadsheet. Scroll around to get a grasp for the types of measurements in the table.</p>

<p>Notice that there are some cells with the value “?1”. This indicates a missing data value.</p>

<p>During today’s studio, we’ll be investigating the sugar content of different cereals. This exploration was inspired by the article <a href="http://www.seriouseats.com/2015/03/history-of-breakfast-cereal-mascots.html">‘How Cereal Became the Quintessential American Breakfast’</a>, which discusses the marketing of cereals as a nutritious breakfast. Many breakfast cereals are considered “healthy” due to their added vitamins and low fat content, but their sugar content may tell a different story.</p>

<p>Now that you’ve become somewhat acquainted with the data, let’s get to know LibreOffice as well.</p>

<h3 id="getting-started">Getting Started</h3>
<p>To highlight a cell you can simply click on it. To highlight consecutive cells, you can click on a cell and drag (left, right, up, down) atop the neighboring cells.</p>

<p>To highlight an entire column, you can click on the column’s letter at the top header. To highlight an entire row, you can click on a row’s number. Try playing around with this. You can also quickly select portions of rows or columns by clicking on a cell and pressing <code class="highlighter-rouge">Shift+Ctrl+↓</code> (or ↑, ← or →). Try highlighting the whole protein column. To undo any highlighting just click on any cell.</p>

<p>As you can probably already tell, when you scroll down, the top row disappears and it becomes hard to remember what variable each column refers to. To make your life easier, it will be helpful to keep the header row frozen at the top of the screen. To do this, highlight any cell in the second row, and choose <code class="highlighter-rouge">Window → Freeze</code>. (To deactivate, choose <code class="highlighter-rouge">Window → Freeze</code> again.) This will freeze everything above the second row. To make your life even easier, let’s make the first column stationary as well.  First, unfreeze the top row. Then click on cell B2 and choose <code class="highlighter-rouge">Window → Freeze</code>. The row above B2 and the column to the left of B2 should both be frozen.</p>

<h3 id="color-scales">Color Scales</h3>
<p>Color scales are a nifty way for us to easily visualize a range of values, and to identify extreme points (maximum and minimum values).</p>

<p>Let’s say we wanted to visualize which cereals are highest and lowest in sugar content (per ounce). We can do so using the conditional formatting tools. Highlight the “grams of sugar” column. Then on the main options bar, go to <code class="highlighter-rouge">Format → Conditional Formatting → Color Scale</code>. Under <code class="highlighter-rouge">Condition 1</code> choose <code class="highlighter-rouge">All Cells</code> and then in the next drop down menu choose <code class="highlighter-rouge">Color Scale (2 entries)</code>. In the drop down menu under <code class="highlighter-rouge">All Cells</code> choose <code class="highlighter-rouge">Min</code>, and in the drop down menu at the top of the rightmost column choose <code class="highlighter-rouge">Max</code>. In the drop-down menu under <code class="highlighter-rouge">Min</code> choose “White” (click on the down arrow if “White” is not a visible choice), and in the one under <code class="highlighter-rouge">Max</code> choose any color you please. Click OK, and then unhighlight the “grams of sugar” column to see the effect. The cells in this column should now be color coded.</p>

<p>A. What two cereals are highest in sugar content?</p>

<p>B. Name one cereal that has no sugar.</p>

<p>C. Could you have detected this information without the aid of color scaling? How did the color scales assist you in answering these queries?</p>

<p>Next, we’d like to compare the sugar content of cereals to that of an Oreo cookie. Sounds like a set of potentially interesting queries: e.g., “Which has more sugar: Fruit loops or Oreos?” But how can we do this comparison? Should we compare the grams of sugar in one fruit loop to the grams of sugar in one cookie? That doesn’t seem quite fair. In fact, our comparison of “grams of sugar” measurements across cereals were likewise unfair!</p>

<h3 id="using-formulas">Using Formulas</h3>
<p>Most of the time, a data set in its raw form does not provide all the information of interest. Do not despair. This can be rectified easily in spreadsheets through the use of formulas.</p>

<p>In the last exercise, you did a cursory comparison of “grams of sugar” across cereals. But this was not actually an apples-to-apples comparison. Why not?  Well, because serving sizes differ! So what we should really be comparing is grams-of-sugar per some unit size. Since serving sizes are measured in ounces, it makes sense to compare sugar content using grams-of-sugar per ounce. Let’s go ahead and compute grams-of-sugar per ounce:</p>

<p>In column Q, create a new column with the title “grams of sugar per ounce.” For starters, we will calculate the grams per ounce for the cereal of row 2. You can see the cereal’s name in cell A2 (100%_Bran). We want to divide the grams of sugar per serving (J2) by the weight in ounces (N2). Thus, in Q2 you should write <code class="highlighter-rouge">=J2/N2</code> (Note: the equal sign is the symbol that denotes the beginning of a formula.) When you press enter, Calc will display the numerical value. However, when you highlight cell Q2, you can see <code class="highlighter-rouge">=J2/N2</code> written in the formula bar up above.</p>

<p>Now, click on your cell where the solution lies and drag down the lower right hand corner until you have highlighted the whole column. What happened? You should have just seen the equation in the first cell be changed to reflect the cereal’s row each step of the way. The values should all be different and cereal specific. Click on Q9 to see what the formula is there.</p>

<p>You will see that Quaker_Oatmeal has <code class="highlighter-rouge">#VALUE!</code> written in its cell. This indicates that there was some kind of error with the formula. This is due to its missing value for grams of sugar (represented by “?1”).</p>

<p>Later in the course, we will talk more about missing data and data cleaning. For now, we want to ignore these missing values, since they will interfere with our later analyses. Delete <code class="highlighter-rouge">#VALUE!</code> for Quaker_Oatmeal, making Q59 an empty cell.</p>

<p>Color scale column Q (“grams of sugar per ounce”) like you did column J (“grams of sugar”) above.</p>

<p>Now let’s compare the sugar content of our cereals to that of Oreo cookies. Oreos have approximately 11.7 grams of sugar per ounce. (One ounce of Oreos is equivalent to approximately 2.5 cookies.) We want to calculate the number of cereals whose sugar content is above this benchmark of 11.7 grams. One easy method is to use the function <code class="highlighter-rouge">COUNTIF</code>. In cell R78, type <code class="highlighter-rouge">=COUNTIF(Q2:Q78, “&gt;11.7”)</code>. This will return the number of cells in the “grams of sugar per ounce” column that have a value greater than 11.7.</p>

<p>D. How many cereals have more sugar per ounce than Oreos?</p>

<h3 id="sorting">Sorting</h3>
<p>Let’s say we want our cereals to be sorted according to their sugar content (per ounce), from least to most (i.e., in ascending order). Let’s see how to do this.</p>

<p>First, highlight the entire spreadsheet (from cell A1 to cell Q78). Then go to <code class="highlighter-rouge">Data→Sort</code> and in the next dialog box, on the <code class="highlighter-rouge">Sort Criteria</code> tab, under <code class="highlighter-rouge">Sort Key 1</code>, select “grams of sugar per ounce” (column Q). The button for <code class="highlighter-rouge">Ascending order</code> should be selected, and <code class="highlighter-rouge">Sort Key 2</code> should be “-undefined-”. Then go to the <code class="highlighter-rouge">Options</code> tab, and make sure the box next to <code class="highlighter-rouge">Range contains column labels</code> is checked. Checking this box tells LibreOffice not to sort the values in the header row, which lists all the variable names. Press <code class="highlighter-rouge">OK</code>.</p>

<p>E. How did your spreadsheet change?</p>

<h3 id="making-charts">Making Charts</h3>
<p>Another informative (and potentially beautiful) way to visualize data is to make charts.</p>

<p>We will begin by making a copy of our original spreadsheet. Go to <code class="highlighter-rouge">Edit → Sheet → Move/Copy</code>. In the window that pops up, make sure the <code class="highlighter-rouge">Copy</code> button is filled in and that you are documenting the “current document.” Name the new spreadsheet “cerealData2.” After you click <code class="highlighter-rouge">OK</code>, check the bottom toolbar to ensure that you now have two spreadsheets: “cerealData” and “cerealData2.” Navigate to “cerealData2” (if you are not there already).</p>

<p>Next, we are going to make some charts. Choose <code class="highlighter-rouge">Insert→Object→Chart</code>. Let’s begin with a simple Column chart. Choose <code class="highlighter-rouge">Column</code>, and then click <code class="highlighter-rouge">Next</code>. The current data range should be <code class="highlighter-rouge">$cerealData2.$A$1:$Q$78</code>. This means that the range is from cell A1 to cell Q78, which is our complete set of data. However, for our chart, we only want to graph the data of two columns: “cereal name” (column A) and “grams of sugar per ounce“ (column Q). To specify these columns, change the data range to be <code class="highlighter-rouge">$cerealData2.A1:A78, $cerealData2.Q1:Q78</code>. Make sure that the buttons and checkboxes for <code class="highlighter-rouge">Data series in columns</code>, <code class="highlighter-rouge">First row as label</code>, and <code class="highlighter-rouge">First column as label</code> are filled in. Now press <code class="highlighter-rouge">Finish</code>.</p>

<p>F. Looking at the chart, estimate the average number of grams of sugar per ounce?</p>

<p>G. Is this chart easier or harder to comprehend than a color-scaled column? Discuss the pros and cons of both visualizations with your partner. There is no right answer.</p>

<p>While the chart allows us visually to estimate the average number grams of sugar per ounce, we can compute the exact value using the formula AVERAGE.</p>

<p>Navigate back to the original spreadsheet. Let’s create a new row to store average values. Type “Average” in cell A79. For now, we’ll just compute the average for column Q. In cell Q79, type <code class="highlighter-rouge">=AVERAGE(Q2:Q78)</code>. You should now see the numerical value in cell Q79.</p>

<p>H. What the average number of grams of sugar per ounce? How good was your estimate?</p>

<h3 id="filtering">Filtering</h3>
<p>There is a <a href="http://theplate.nationalgeographic.com/2015/06/15/surviving-the-sneaky-psychology-of-supermarkets/">psychology behind the layouts of supermarkets</a> that is intended to manipulate consumer purchases. Decision variables include whether departments are located in the back or front of stores, where items are stacked on the shelves, and more. In our cerealData spreadsheet, you should notice that there is a column titled “display shelf.” There are 3 grocery shelf locations: 1, 2, and 3, which correspond to bottom, middle, and top shelves, respectively. We are going to conduct an analysis to see if we can detect any associations between cereals and their shelves.</p>

<p>Let’s begin by talking about filtering, a tool that allows you to display only those observations that meet certain criteria. We will use filtering to look at one display shelf at a time.</p>

<p>Highlight all of column M (“display shelf”) and then go to <code class="highlighter-rouge">Data → Filter → AutoFilter</code>. In cell M1 (which contains the column header “display shelf”) you should now see a box with a downward pointing arrow. When you click on the box, a dropdown menu should appear. Find the area with three checkboxes labeled <code class="highlighter-rouge">1</code>, <code class="highlighter-rouge">2</code>, and <code class="highlighter-rouge">3</code>. These are the three different values for our display shelves. Uncheck the boxes <code class="highlighter-rouge">2</code> and <code class="highlighter-rouge">3</code> and then click <code class="highlighter-rouge">OK</code>.</p>

<p>Now only the cereals on display shelf 1 should be visible. Play around with the filter to see if you can get only cereals on shelf 2 to appear. Then only the cereals on shelf 3.</p>

<h3 id="pivot-tables">Pivot Tables</h3>
<p>Next, we are going to summarize the sugar content of cereals grouped by shelf. We can do this using Pivot Tables.</p>

<p>Remove any filters so that all 77 cereals are now visible. You can do this by checking the boxes <code class="highlighter-rouge">1</code>, <code class="highlighter-rouge">2</code>, and <code class="highlighter-rouge">3</code> in the AutoFilter box.</p>

<p>Next, highlight the entire spreadsheet. Go to <code class="highlighter-rouge">Data → Pivot Table → Create</code>. Make sure that the <code class="highlighter-rouge">Current Selection</code> button is filled in, and then click <code class="highlighter-rouge">OK</code>.</p>

<p>In the Pivot Table Layout box that pops up, drag “display shelf” to <code class="highlighter-rouge">Row Fields</code> and then “grams of sugar per ounce” to <code class="highlighter-rouge">Data Fields</code>. The default settings will display “Sum - grams of sugar per ounce.” However, we want to find the average number of grams. Double click on the word “Sum” and then select “Average.” Your settings should now display “Mean - grams of sugar per ounce.” Click on the <code class="highlighter-rouge">Options</code> drop down menu and check the box for <code class="highlighter-rouge">Ignore empty rows</code>. (You should remember that we had an empty cell for Quaker_Oatmeal.) Then press <code class="highlighter-rouge">OK</code>.</p>

<p>You will be redirected to a new spreadsheet displaying your Pivot Table. You should see the average sugar content per shelf, as well as the overall average (which should match the average you calculated previously!). You will also see a column labelled “empty,” which appears because of the “Average” entry in row 79 does not appear on any shelf.</p>

<p>I. What is the average grams of sugar per ounce for cereals on shelves 1, 2, and 3?</p>

<p>If you make any changes to the data in your original spreadsheet, you can refresh your Pivot Table to reflect the new information. Let’s go through an example of how to do this. Return to your cerealData spreadsheet, and in cell Q78 (grams of sugar per ounce for Quaker_Oatmeal, which is on shelf 1), type 500. Then go to your Pivot Table sheet, highlight your table, and then go to <code class="highlighter-rouge">Data → Pivot Table → Refresh</code>. You should see that the average for display shelf 1 and the overall average should increase dramatically.</p>

<p>Before moving on, change your cerealData spreadsheet back to its original values. That is, clear Q78 in cerealData, and then refresh your Pivot Table once again.</p>

<h3 id="creating-charts-from-a-pivot-table">Creating Charts from a Pivot Table</h3>
<p>Let’s make a column chart to visualize the averages that are in the Pivot Table. Highlight the Pivot Table and then go to <code class="highlighter-rouge">Insert→Object→Chart</code>. Select a Column chart and then change your <code class="highlighter-rouge">Data Range</code> to include cells from A1 to B4 (we don’t want to visualize the overall averages, so you should exclude row 5 and 6). Ensure that the buttons and checkboxes for <code class="highlighter-rouge">Data series in columns</code>, <code class="highlighter-rouge">First row as label</code>, and <code class="highlighter-rouge">First column as label</code> are filled in. Then press <code class="highlighter-rouge">Finish</code>.</p>

<p>If it was not already clear from your Pivot Table, it should now be eminently clear that the cereals on shelf 2 (the middle shelf) have the highest average sugar content. Moreover, items on the middle shelves are the easiest to see and reach.</p>

<p>Navigate back to the cerealData sheet and use the “display shelf” filter to look at the cereals on shelves 1 and 3. You’ll notice that many of these cereals include “bran” and “wheat.” Contrast them with the cereals on shelf 2, where you’ll see several cereals that are marketed to children, like Cinnamon Toast Crunch, Fruity Pebbles, and Cocoa Puffs.</p>

<p>This is a rather unfortunate finding: supermarkets encourage shoppers to buy these high-sugar cereals by displaying them on the middle shelf. The healthier options on the top and bottom shelves can easily be overlooked, especially by children.</p>

<p>Before proceeding to the final portion of today’s studio raise your hand so that a TA can come by and review your work so far. Once a TA has approved, you may continue on to the final task:</p>

<h3 id="your-own-exploration">Your Own Exploration</h3>
<p>Your last task is to create another chart visualizing other the measurements (you need not limit your exploration to just sugar). Be creative and see if you can find any interesting associations in the data set. Feel free to call over a TA if you need help or want to brainstorm about ideas.</p>

<p>J. What did you chart and why?</p>

<p>When you are done please raise your hand. A TA will review your final visualization and then check you off for the studio. If you do not finish within the 2-hour studio period, remember to come to TA office hours to get checked off.</p>


            </div>
        </div>
    </div>

</article>

    </div>

    <footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-6 text-center">
                <p>CS100: Data Fluency for All</p>
            </div>
            <div class="col-lg-6 text-center">
                <p>Contact the TAs: <a href="mailto:cs100tas@cs.brown.edu">cs100tas@cs.brown.edu</p>
            </div>
        </div>
    </div>
</footer>


  </body>

</html>
